# RESTful API

## API调用规范

RESTful API是Tenured给提供App后台的HTTP/HTTPS管理接口，其主要目的在于为 App 后台提供一个统一全功能后台管理入口。

为安全保证API接口安全性，无论是公有云还是私有云均需[安全效验]()。

- [公有云对接说明]()
- [私有云对接说明]()
- [安全效验方式]()

### 请求规范

请求地址：
```
公有云：http://api-tenured.renzhen.la/$version/$serverModule/$serverCommand
私有云：http://serverHost:serverPort/$version/$serverModule/$serverCommand
```

请求共有`header`安全数据：

参数名 |  参数类型 |  描述
------|----------|-----------
tenured_app_id | string | 共有云申请或者私有设置的App ID
tenured_ak | string | 应用申请的AK 
tenured_sign | string | 安全校验值[安全校验]() 

请求的其他非安全数据，均已按照restfull api标准传输。且POST,PUT均已`Content-Type: application/json`方式提交。

### 结果返回规范

HTTP 状态码均为 `200`，标示接口请求成功。

其他HTTP状态吗均为请求错误，具体原因查阅json body 的 error、message 来表示的。

例如：

```json
{"error":"1000","message":"非法调用"}
```



## 接口说明

### 账户类接口

#### 获取IM登录Token（独立账号模式）
此接口用于对接服务端传递新im登录的地址和token

请求url `POST /v1/account/token`

 参数名称  |   参数类型  |    描述  
----------|-------------|----------
 userId     | string   | 第三方系统的用户ID，全局唯一                
 expireTime | string   | 申请token的过期时间，如果数据为空则不过期。 

`注：如果当前APP设计为不可多端登录，当有新的token申请后将导致当前登录用户直接下线。`

响应参数

 参数名称 |   参数类型   
-------- |-------------
 token       | 登录使用的TOKEN 
 expireTime  | 过期时间        
  linkAddress  | 连接服务地址 

请求示例

```json
{
    "userId":"100001"
}
```
响应结果示例

```json
{
    "token":"123123123123123",
    "expireTime":null,
 	"linkAddress":"192.168.0.10:9999"
}
```



#### 账户管理

##### 创建单个账户接口
###### 接口描述
创建tenured账户，并用app自有账户与tenured账户关联，该接口主要是在tenured中创建一与之关联的内部ID,以确保app自有账户能正常使用tenured服务
注：接口响应结果统一为json格式
####### 请求url
POST：/v1/build_account
####### 请求参数
 参数名称  |   参数类型  |    描述  
----------|-------------|----------
appId     |   String    |    控制台创建应用分配appId
sign      |   String    |    签名(或token)


####### 请求body参数说明
 参数名称  |   参数类型  |    描述  
----------|-------------|----------
id        |   String    |    第三方系统ID
userId    |   String    |    第三方系统用户ID
aliasName |   String    |    用户别名
userName  |   String    |    用户昵称
sex       |   Integer   |    性别
headImgUrl|   String    |    用户头像url

####### 响应参数
 参数名称 |   参数类型   |    描述  
-------- |-------------|----------
  error  |   String    |  错误码，0000标示成功，非0000标示失败        
  message|   String    |  错误信息        
  data   |   String    |  null        

####### 请求体示例
    { }
####### 响应结果示例
    { }

###### 错误码说明
    HTTP 状态码均为 200，标示接口请求结果，真正的错误码，错误信息是通过应答包体中的 error、message 来表示的。
    本 API 私有错误码如下：
 错误码  |   描述   
--------|----------
  0000  |   正确结果
  0000  |   正确结果
  0000  |   正确结果


#### 批量创建账户接口
##### 接口描述
批量创建tenured账户，并用app自有账户与tenured账户关联，该接口主要是在tenured中创建一与之关联的内部ID,以确保app自有账户能正常使用tenured服务
注：接口响应结果统一为json格式
###### 请求url
POST：/v1/batch_build_account
###### 请求参数
 参数名称  |   参数类型  |    描述  
----------|-------------|----------
id        |   String    |    第三方系统ID
userId    |   String    |    第三方系统用户ID
aliasName |   String    |    用户别名
userName  |   String    |    用户昵称
sex       |   Integer   |    性别
headImgUrl|   String    |    用户头像url

###### 响应结果
 参数名称 |   参数类型   |    描述  
-------- |-------------|----------
  error  |   String    |  错误码，0000标示成功，非0000标示失败        
  message|   String    |  错误信息        
  data   |   String    |  null        

###### 请求体示例
    { }
###### 响应结果示例
    { }

##### 错误码说明
    HTTP 状态码均为 200，标示接口请求结果，真正的错误码，错误信息是通过应答包体中的 error、message 来表示的。
    本 API 私有错误码如下：
 错误码  |   描述   
--------|----------
  0000  |   正确结果


<!--
## 单聊消息
### 单发单聊消息
### 批量发单聊消息
### 导入单聊消息（现有服务迁入新服务）

## 在线状态
### 获取用户在线状态

## 资料管理
### 拉取资料
### 设置资料

## 关系链管理
### 添加好友
### 拉取好友
### 拉取所有好友
### 导入好友（现有服务迁入新服务）
### 更新好友
### 删除好友
### 删除所有好友
### 添加黑名单
### 删除黑名单
### 拉取黑名单
### 添加分组
### 删除分组

## 群组管理
### 创建群组
### 更新群组资料
### 解散群组
### 拉取群组资料
### 设置群主
### 添加群成员（邀请进群、静默进群）
### 拉取群成员资料
### 修改群成员资料
### 删除群成员
### 群成员退出群
### 在群组中发送普通消息
### 在群组中发送系统消息
### 删除指定用户发送的消息
### 批量禁言
### 取消批量禁言
### 群组消息撤回
### 设置群组成员未读消息计数

## 脏字管理
### 查询app定义脏字
### 添加app定义脏字
### 删除app定义脏字

## 全局禁言管理
### 设置全局禁言
### 查询全局禁言

-->




## 错误码说明
    HTTP 状态码均为 200，标示接口请求结果，真正的错误码，错误信息是通过应答包体中的 error、message 来表示的。
### 全局错误码

 错误码  |   描述
--------|----------
  1000  | 安全校验数据错误，非法调用，出现此错误,需要检查APPID,AK,SIGN是否填写正确 
 1001 | APP不存在 
 1002 | API调用频率过高，对接方被限流 
  |  
  |  

###账户类错误码：

| 错误码 | 描述       |
| ------ | ---------- |
| 2001   | 用户不存在 |
|        |            |

